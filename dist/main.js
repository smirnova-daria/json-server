(()=>{"use strict";const t=t=>{const e=document.getElementById("table-body");e.innerHTML="",t.forEach((t=>{e.insertAdjacentHTML("beforeend",`\n\t\t\t<tr data-key="${t.id}">\n\t\t\t\t<th scope="row">${t.id}</th>\n\t\t\t\t<td>${t.name}</td>\n\t\t\t\t<td>${t.email}</td>\n\t\t\t\t<td>${t.children?"Есть":"Нет"}</td>\n\t\t\t\t<td>\n\t\t\t\t\t<div class="form-check form-switch">\n\t\t\t\t\t\t<input class="form-check-input" type="checkbox" role="switch"\n\t\t\t\t\t\t\tid="form-children" ${t.permissions?"checked":""}>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t\t\t<div class="btn-group btn-group-sm" role="group" aria-label="Basic example">\n\t\t\t\t\t\t<button type="button" class="btn btn-warning btn-edit">\n\t\t\t\t\t\t\t<i class="bi-pencil-square"></i>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button type="button" class="btn btn-danger btn-remove">\n\t\t\t\t\t\t\t<i class="bi-person-x"></i>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t`)}))};window.userService=new class{getUsers(){return fetch("http://localhost:4545/users").then((t=>t.json()))}addUser(t){return fetch("http://localhost:4545/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>t.json()))}removeUser(t){return fetch(`http://localhost:4545/users/${t}`,{method:"DELETE"}).then((t=>t.json()))}changeUser(t,e){return fetch(`http://localhost:4545/users/${t}`,{method:"PATCH",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((t=>t.json()))}getUser(t){return fetch(`http://localhost:4545/users/${t}`).then((t=>t.json()))}editUser(t,e){return fetch(`http://localhost:4545/users/${t}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((t=>t.json()))}filterUsers(t){return fetch(`http://localhost:4545/users?${t}=true`).then((t=>t.json()))}getSortUsers(t){return fetch(`http://localhost:4545/users?_sort=${t.name}&_order=${t.value}`).then((t=>t.json()))}getSearchUser(t){return fetch(`http://localhost:4545/users?name_like=${t}`).then((t=>t.json()))}},userService.getUsers().then((e=>{t(e)})),(()=>{const e=document.querySelector("form"),r=e.querySelector("#form-name"),n=e.querySelector("#form-email"),s=e.querySelector("#form-children");e.addEventListener("submit",(c=>{if(c.preventDefault(),!e.dataset.method){const c={name:r.value,email:n.value,children:s.checked,permissions:!1};userService.addUser(c).then((()=>{userService.getUsers().then((r=>{t(r),e.reset()}))}))}}))})(),document.getElementById("table-body").addEventListener("click",(e=>{if(e.target.closest(".btn-remove")){const r=e.target.closest("tr").dataset.key;userService.removeUser(r).then((e=>{userService.getUsers().then((e=>{t(e)}))}))}})),document.getElementById("table-body").addEventListener("click",(e=>{if(e.target.closest("input[type=checkbox]")){const r=e.target.closest("tr"),n=r.querySelector("input[type=checkbox]"),s=r.dataset.key;userService.changeUser(s,{permissions:n.checked}).then((e=>{userService.getUsers().then((e=>{t(e)}))}))}})),(()=>{const e=document.getElementById("table-body"),r=document.querySelector("form"),n=r.querySelector("#form-name"),s=r.querySelector("#form-email"),c=r.querySelector("#form-children");e.addEventListener("click",(t=>{if(t.target.closest(".btn-edit")){const e=t.target.closest("tr").dataset.key;userService.getUser(e).then((t=>{n.value=t.name,s.value=t.email,c.checked=t.children,r.dataset.method=e}))}})),r.addEventListener("submit",(e=>{if(e.preventDefault(),r.dataset.method){const e=r.dataset.method,o={name:n.value,email:s.value,children:c.checked,permissions:!1};userService.editUser(e,o).then((()=>{userService.getUsers().then((e=>{t(e),r.reset(),r.removeAttribute("data-method")}))}))}}))})(),(()=>{const e=document.getElementById("btn-isChildren"),r=document.getElementById("btn-isPermissions"),n=document.getElementById("btn-isAll");e.addEventListener("click",(()=>{userService.filterUsers("children").then((e=>{t(e)}))})),r.addEventListener("click",(()=>{userService.filterUsers("permissions").then((e=>{t(e)}))})),n.addEventListener("click",(()=>{userService.getUsers().then((e=>{t(e)}))}))})(),(()=>{const e=document.getElementById("sort-is-children");e.style.cursor="pointer";let r=!1;e.addEventListener("click",(e=>{userService.getSortUsers({name:"children",value:r?"asc":"desc"}).then((e=>{t(e)})),r=!r}))})(),(()=>{const e=document.getElementById("search-input"),r=((t,e=300)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout((()=>{t.apply(void 0,n)}),e)}})((()=>{userService.getSearchUser(e.value).then((e=>{t(e)}))}),500);e.addEventListener("input",r)})()})();